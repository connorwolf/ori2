{"version":3,"file":"PluginHost.js","sourceRoot":"","sources":["../../app/plugins/PluginHost.ts"],"names":[],"mappings":";;AAAA,yBAAyB;AAIzB,MAAa,UAAU;IAItB,YAAY,GAAkB,EAAE,MAAkB;QACjD,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;QACf,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,KAAK,EAAE,CAAC;IACd,CAAC;IAEO,KAAK;QACZ,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,EAAE;YAC3C,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,sBAAsB,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,iBAAiB,CAAC,CAAC;YACtF,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;YACnB,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC;YACrB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YACvE,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;QACrB,CAAC,CAAC,CAAC;IACJ,CAAC;CACD;AAnBD,gCAmBC","sourcesContent":["import * as fs from \"fs\";\nimport { KrystalClient } from \"../KrystalClient\";\nimport { BasePlugin } from \"./BasePlugin\";\n\nexport class PluginHost {\n\tpublic bot: KrystalClient;\n\tpublic plugin: BasePlugin;\n\n\tconstructor(bot: KrystalClient, plugin: BasePlugin) {\n\t\tthis.bot = bot;\n\t\tthis.plugin = plugin;\n\t\tthis.watch();\n\t}\n\n\tprivate watch() {\n\t\tfs.watchFile(this.plugin.options.path, () => {\n\t\t\tthis.bot.logger.info(`Changes to plugin \"${this.plugin.options.name}\", reloading...`);\n\t\t\tthis.plugin.stop();\n\t\t\tthis.plugin.unload();\n\t\t\tthis.plugin = new (require(`./${this.plugin.options.path}`))(this.bot);\n\t\t\tthis.plugin.start();\n\t\t});\n\t}\n}"]}